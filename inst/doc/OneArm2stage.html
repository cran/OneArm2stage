<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>OneArm2stage</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">OneArm2stage</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <code>OneArm2stage</code> package serves multiple purposes,
including:</p>
<ul>
<li>Planning sample sizes and other design parameters for single-arm
phase II trials with time-to-event (TOE) endpoints.</li>
<li>Conducting interim analyses, which involve making Go/No-go
decisions, as well as the final analysis in survival trials.</li>
</ul>
<p>Clinical researchers can leverage the functions within this package
when conducting clinical trials focused on immunotherapies or
molecularly targeted therapies for cancer, where the TOE endpoint is
commonly chosen as the primary outcome measure. One notable advantage of
this package is its ability to calculate design power with increased
precision by utilizing the exact variance in the one-sample log-rank
test (Wu et al., 2020). Furthermore, it offers multiple design solutions
simultaneously for single-arm phase II survival trials, including
optimal, minmax, and admissible two-stage designs (Wu et al., 2020 and
Jung, 2004).</p>
<p>The optimal method is designed to minimize the expected sample size
(<span class="math inline">\(ES\)</span>) under H0, <span class="math display">\[EN=PS_{H_0} \times n_1 + (1-PS_{H_0}) \times
n,\]</span> where <span class="math inline">\(PS_{H_0}\)</span> is the
early stopping probability under the null hypothesis, <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n\)</span> are the sample size for the first stage
and total sample size, respectively. In contrast, the minmax method
minimizes the total sample size <span class="math inline">\(n\)</span>.</p>
<p>The admissible methods aim to find a middle ground between the
optimal and minmax methods by minimizing the following loss function:
<span class="math display">\[\rho=q\times n_d + (1-q) \times EN_d
\space. \]</span> In this equation, <span class="math inline">\(q\)</span> represents the relative importance
between the maximum sample size (n) and the expected sample size under
H0 (ES). The variable <span class="math inline">\(d\)</span> signifies
each individual design, with its total sample size ranging from that of
the minmax method to the optimal method under the same trial
conditions.</p>
<p>The admissible method within this package suggests selecting the
design with the lowest <span class="math inline">\(\rho\)</span> value
from the options considered (refer to Example 1). This method proves
especially useful in scenarios where a significant reduction in either
the expected sample size (ES) or the total sample size (n) can be
accomplished without significantly compromising the other parameter. For
additional information regarding the admissible method, please consult
Jung, 2004.</p>
<p>The selection among the three design methods mentioned can be
determined by considering the distinct characteristics of each trial,
taking into account both statistical considerations and
clinical/administrative requirements. Additionally, the package allows
for both restricted and unrestricted follow-up. For instance, in a
design with a restricted follow-up of 3 years, each patient will be
followed for 3 years (provided there are no events within the 3 years).
Furthermore, any patient who reaches the end of this follow-up period
without experiencing an event will be censored at the end of the 3 years
for the interim and final analyses. In contrast, in a design with
unrestricted follow-up also set at 3 years, the requirement is for the
last patient enrolled in the trial to be followed for 3 years (provided
there are no events). However, any patient enrolled before the last one
will not be censored for the interim and final analyses if they have
been followed for more than 3 years.</p>
<p>The following vignette illustrates the process of designing
single-arm two-stage survival trials and conducting analyses/simulations
using this package.</p>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(OneArm2stage)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(IPDfromKM)</span></code></pre></div>
<div id="example-1-designing-a-study-with-unrestricted-follow-up" class="section level3">
<h3>Example 1 (Designing a Study with Unrestricted Follow-Up)</h3>
<p>Let’s consider the scenario where we’re designing a study with the
primary endpoint being 3-year event-free survival (EFS) for sample size
planning. The hypotheses under consideration are as follows:</p>
<ul>
<li>Null Hypothesis (H0): S0 = 72%</li>
<li>Alternative Hypothesis (H1): S1 = 86%</li>
</ul>
<p>These hypotheses pertain to the landmark time point of 3 years
(x0=3). This is equivalent to assuming a hazard ratio of 0.459, provided
that survival time follows the proportional hazard assumption (<span class="math inline">\(0.72^{0.459}=0.86\)</span>). In this particular
study, we assume a historical accrual rate of 20 patients per year, and
each patient has an unrestricted follow-up time of 3 years (restricted=0
and tf=3).</p>
<p>Given a type I error rate of 0.05 and a desired power of 0.8, with
failure times following a Weibull distribution with shape = 1, we can
employ the function phase2.TTE to plan this study, as demonstrated
below.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Design1 <span class="ot">&lt;-</span> <span class="fu">phase2.TTE</span>(<span class="at">shape=</span><span class="dv">1</span>,<span class="at">S0=</span><span class="fl">0.72</span>,<span class="at">x0=</span><span class="dv">3</span>,<span class="at">hr=</span><span class="fl">0.459</span>,<span class="at">tf=</span><span class="dv">3</span>,<span class="at">rate=</span><span class="dv">20</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">beta=</span><span class="fl">0.2</span>, <span class="at">restricted=</span><span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Design1</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_Optimal</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   n1      c1  n      c     t1 MTSL      ES     PS</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 22 -0.7215 46 1.5952 1.0619  5.3 40.1736 0.2353</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_minmax</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   n1     c1  n      c     t1 MTSL      ES     PS</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 34 -0.731 44 1.6257 1.6997  5.2 41.6745 0.2324</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_Admissible</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     n1      c1  n      c     t1 MTSL      ES     PS      Rho</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 88  26 -0.7274 45 1.6061 1.2512 5.25 40.3361 0.2335 42.66805</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 98  29 -1.0069 44 1.6293 1.4269 5.20 41.5723 0.1570 42.78615</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 108 21 -0.7393 46 1.5952 1.0326 5.30 40.1736 0.2298 43.08680</span></span></code></pre></div>
<p>The output from phase2.TTE provides design solutions based on three
methods. If we opt for the optimal method, we need to plan for an
accrual time of 1.06 years (equivalent to enrolling 22 patients assuming
an accrual rate of 20) in the 1st stage before conducting the interim
analysis. If the decision is to proceed (“Go”), we will enroll an
additional 24 patients (<span class="math inline">\(46 - 22 =
24\)</span>) for the final analysis. Critical values for the 1st and 2nd
stages are -0.7215 and 1.5952, respectively. Overall, this study will
take a maximum of 5.3 years to complete and is expected to have a sample
size of 40.1736 under H0. The probability of early stopping under H0 is
23.53%.</p>
<p>Similarly, if we choose the minmax method, we need to plan for an
accrual time of 1.70 years (equivalent to enrolling 34 patients assuming
an accrual rate of 20) in the 1st stage before conducting the interim
analysis. If the decision is to proceed (“Go”), we will enroll an
additional 10 patients (<span class="math inline">\(44 - 34 =
10\)</span>) for the final analysis. Critical values for the 1st and 2nd
stages are -0.731 and 1.6257, respectively. Overall, this study will
take a maximum of 5.2 years to complete and is expected to have a sample
size of 41.6745 under H0. The probability of early stopping under H0 is
23.24%.</p>
<p>The admissible method recommends the design with the smallest <span class="math inline">\(\rho\)</span> value among the considered designs
(the first row in outputs, <span class="math inline">\(\rho=42.66805\)</span>). If we opt for this
admissible design, we need to plan for an accrual time of 1.25 years
(equivalent to enrolling 26 patients assuming an accrual rate of 20) in
the 1st stage before conducting the interim analysis. If the decision is
to proceed (“Go”), we will enroll an additional 19 patients (<span class="math inline">\(45 - 26 = 19\)</span>) for the final analysis.
Critical values for the 1st and 2nd stages are -0.7274 and 1.6061,
respectively. Overall, this study will take a maximum of 5.25 years to
complete and is expected to have a sample size of 40.3361 under H0. The
probability of early stopping under H0 is 23.35%.</p>
</div>
<div id="example-2-when-early-stopping-probability-is-pre-defined" class="section level3">
<h3>Example 2 (When Early Stopping Probability is Pre-Defined)</h3>
<p>If there is a need to pre-define the early stopping probability under
H0, you can do so by using the argument <code>prStop</code>. This
argument defines the the lower limit of the early stopping probability
under H0. The default value for “prStop” is 0, which technically means
the early stopping probability is <span class="math inline">\(&gt;=
0\)</span>. Essentially, it also means there is no restriction on the
early stopping probability as any probability should be equal or larger
than 0. In the following example, we set the early stopping probability
to be at least 35%.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Design2 <span class="ot">&lt;-</span> <span class="fu">phase2.TTE</span>(<span class="at">shape=</span><span class="dv">1</span>,<span class="at">S0=</span><span class="fl">0.72</span>,<span class="at">x0=</span><span class="dv">3</span>,<span class="at">hr=</span><span class="fl">0.459</span>,<span class="at">tf=</span><span class="dv">3</span>,<span class="at">rate=</span><span class="dv">20</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">beta=</span><span class="fl">0.2</span>, <span class="at">prStop=</span><span class="fl">0.35</span>, <span class="at">restricted=</span><span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Design2</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_Optimal</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   n1      c1  n      c     t1 MTSL      ES     PS</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 29 -0.3844 47 1.5799 1.4364 5.35 40.5985 0.3503</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_minmax</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   n1      c1  n      c     t1 MTSL      ES     PS</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 40 -0.3829 44 1.6171 1.9808  5.2 42.4619 0.3509</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_Admissible</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     n1      c1  n      c     t1 MTSL      ES     PS      Rho</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 92  34 -0.3850 45 1.5988 1.6732 5.25 40.9611 0.3501 42.98055</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 102 40 -0.3846 44 1.6171 1.9791 5.20 42.4522 0.3503 43.22610</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 921 31 -0.3851 46 1.5884 1.5339 5.30 40.6365 0.3501 43.31825</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 91  29 -0.3850 47 1.5799 1.4353 5.35 40.5949 0.3501 43.79745</span></span></code></pre></div>
<p>We can compare the outputs above with those in Example 1. In each of
the designs, the early stopping probability (PS) under H0 is now set at
35%. This strategy allows for a higher probability of early termination
of an ineffective drug during the trial process. We should also be aware
that using this approach necessitates larger sample sizes, particularly
for the 1st stage. For example, in the optimal design, setting PS to 35%
results in sample sizes of 29 for the 1st stage and 47 for the 2nd
stage, whereas in the first example, the sample sizes were 22 for the
1st stage and 46 for the 2nd stage.</p>
</div>
<div id="example-3-exploring-the-admissible-method-further" class="section level3">
<h3>Example 3 (Exploring the Admissible Method Further)</h3>
<p>The design derived from the admissible method can be fine-tuned by
adjusting <code>q_value</code>, the parameter determines the relative
importance assigned to the maximum sample size (n) versus the expected
sample size under H0 (ES) when creating the admissible method-based
design. Its default value is 0.5, with a range of (0, 1). Smaller values
of <code>q_value</code> emphasize ES, while larger values prioritize the
maximum sample size, n. Let’s compare the results using the code
below.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Design3 <span class="ot">&lt;-</span> <span class="fu">phase2.TTE</span>(<span class="at">shape=</span><span class="dv">1</span>,<span class="at">S0=</span><span class="fl">0.72</span>,<span class="at">x0=</span><span class="dv">3</span>,<span class="at">hr=</span><span class="fl">0.459</span>,<span class="at">tf=</span><span class="dv">3</span>,<span class="at">rate=</span><span class="dv">20</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">beta=</span><span class="fl">0.2</span>, <span class="at">q_value=</span><span class="fl">0.1</span>, <span class="at">restricted=</span><span class="dv">0</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Design3_2 <span class="ot">&lt;-</span> <span class="fu">phase2.TTE</span>(<span class="at">shape=</span><span class="dv">1</span>,<span class="at">S0=</span><span class="fl">0.72</span>,<span class="at">x0=</span><span class="dv">3</span>,<span class="at">hr=</span><span class="fl">0.459</span>,<span class="at">tf=</span><span class="dv">3</span>,<span class="at">rate=</span><span class="dv">20</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">beta=</span><span class="fl">0.2</span>, <span class="at">q_value=</span><span class="fl">0.7</span>, <span class="at">restricted=</span><span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># q_value = 0.1</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Design3</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_Admissible</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     n1      c1  n      c     t1 MTSL      ES     PS      Rho</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 108 21 -0.7393 46 1.5952 1.0326 5.30 40.1736 0.2298 40.75624</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 88  26 -0.7274 45 1.6061 1.2512 5.25 40.3361 0.2335 40.80249</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 98  29 -1.0069 44 1.6293 1.4269 5.20 41.5723 0.1570 41.81507</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># q_value = 0.7</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>Design3_2</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_Admissible</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     n1      c1  n      c     t1 MTSL      ES     PS      Rho</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 98  29 -1.0069 44 1.6293 1.4269 5.20 41.5723 0.1570 43.27169</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 88  26 -0.7274 45 1.6061 1.2512 5.25 40.3361 0.2335 43.60083</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 108 21 -0.7393 46 1.5952 1.0326 5.30 40.1736 0.2298 44.25208</span></span></code></pre></div>
<p>Modifications to the <code>q_value</code> solely impact the
admissible method. Consequently, the designs obtained through the
optimal and minmax methods remain unchanged from those presented in
Example 1 (details not shown here). Compared to Design1 in Example 1:
when <code>q_value</code> equals 0.1, the admissible design (n=46)
closely resembles the design stemming from the optimal method, which
prioritizes ES. Conversely, when <code>q_value</code> is set to 0.7, the
design (n=44) more closely aligns with the design derived from the
minmax method, emphasizing n.</p>
</div>
<div id="example-4-conducting-interimfinal-analysis" class="section level3">
<h3>Example 4 (Conducting Interim/Final Analysis)</h3>
<p>Let’s assume we opt for the design based on the admissible method. We
would need to plan for an accrual time of 1.2512 years (equivalent to
enrolling 26 patients, assuming a rate of 20 patients per year) in the
1st stage before conducting the interim analysis. If the decision is to
proceed (“Go”), we will enroll an additional 19 patients in the 2nd
stage (45 – 26 = 19) to perform the final analysis. The critical values
for the 1st and 2nd stages are -0.7274 and 1.6061, respectively. In
total, this study will take a maximum of 5.25 years to complete, with an
expected sample size of 40.3361 under H0. The probability of early
termination under H0 is 23.35%.</p>
<p>Suppose we have adhered to the aforementioned design and gathered
data from 26 patients for four variables:</p>
<ul>
<li><code>Entry</code> (the point at which patients enter the
trial),</li>
<li><code>Time</code> (the observed time that patients spend in the
trial),</li>
<li><code>Status</code> (an indicator of patient status), and</li>
<li><code>Total</code> (the sum of <code>Entry</code> and
<code>Time</code>), as illustrated below.</li>
</ul>
<p>For those interested in trying the example themselves, the data
samples used can be located in the folder at /OneArm2stage/extdata.</p>
<pre><code>#&gt;         Entry      time status     Total
#&gt; 16 0.00140574 1.2497943      0 5.2500000
#&gt; 5  0.10312013 1.1480799      0 5.2500000
#&gt; 11 0.21339149 1.0378085      0 5.2500000
#&gt; 24 0.23144545 1.0197546      0 5.2500000
#&gt; 21 0.25005470 1.0011453      0 5.2500000
#&gt; 7  0.27427333 0.9769267      0 5.2500000
#&gt; 9  0.28694621 0.9642538      0 5.2500000
#&gt; 1  0.31231364 0.9388864      0 5.2500000
#&gt; 26 0.39386846 0.8573315      0 5.2500000
#&gt; 8  0.46469563 0.4029726      1 0.8676682
#&gt; 18 0.49526749 0.3440752      1 0.8393427
#&gt; 2  0.52432672 0.7268733      0 2.6966289
#&gt; 22 0.54814381 0.7030562      0 5.2500000
#&gt; 4  0.59843844 0.6527616      0 1.7345921
#&gt; 13 0.61736320 0.6338368      0 5.2500000
#&gt; 20 0.79154530 0.4596547      0 2.8812490
#&gt; 10 0.84254125 0.4086588      0 5.2500000
#&gt; 19 0.85458721 0.3966128      0 1.7934731
#&gt; 12 0.86393169 0.3872683      0 5.2500000
#&gt; 23 0.93970525 0.3114947      0 5.2500000
#&gt; 25 0.97850867 0.2726913      0 5.2500000
#&gt; 15 0.98962130 0.2615787      0 4.8438482
#&gt; 6  0.99495017 0.2562498      0 5.2500000
#&gt; 14 1.00916177 0.2420382      0 2.0781127
#&gt; 3  1.04841551 0.2027845      0 5.2500000
#&gt; 17 1.06946229 0.1817377      0 5.2500000</code></pre>
<p>We can create a Kaplan-Meier survival curve using this hypothetical
dataset (dat1, n=26). <img src="data:image/png;base64,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" /><!-- --></p>
<p>The survival rates, as estimated by the Kaplan-Meier method, can also
be obtained using this hypothetical dataset (dat1, n=26).</p>
<pre><code>#&gt; Call: survfit(formula = Surv(time, status) ~ 1, data = dat1, conf.type = &quot;log-log&quot;)
#&gt; 
#&gt;   time n.risk n.event survival std.err lower 95% CI upper 95% CI
#&gt;  0.182     26       0    1.000  0.0000           NA           NA
#&gt;  0.203     25       0    1.000  0.0000           NA           NA
#&gt;  0.242     24       0    1.000  0.0000           NA           NA
#&gt;  0.256     23       0    1.000  0.0000           NA           NA
#&gt;  0.262     22       0    1.000  0.0000           NA           NA
#&gt;  0.273     21       0    1.000  0.0000           NA           NA
#&gt;  0.311     20       0    1.000  0.0000           NA           NA
#&gt;  0.344     19       1    0.947  0.0512        0.681        0.992
#&gt;  0.387     18       0    0.947  0.0512        0.681        0.992
#&gt;  0.397     17       0    0.947  0.0512        0.681        0.992
#&gt;  0.403     16       1    0.888  0.0748        0.621        0.971
#&gt;  0.409     15       0    0.888  0.0748        0.621        0.971
#&gt;  0.460     14       0    0.888  0.0748        0.621        0.971
#&gt;  0.634     13       0    0.888  0.0748        0.621        0.971
#&gt;  0.653     12       0    0.888  0.0748        0.621        0.971
#&gt;  0.703     11       0    0.888  0.0748        0.621        0.971
#&gt;  0.727     10       0    0.888  0.0748        0.621        0.971
#&gt;  0.857      9       0    0.888  0.0748        0.621        0.971
#&gt;  0.939      8       0    0.888  0.0748        0.621        0.971
#&gt;  0.964      7       0    0.888  0.0748        0.621        0.971
#&gt;  0.977      6       0    0.888  0.0748        0.621        0.971
#&gt;  1.001      5       0    0.888  0.0748        0.621        0.971
#&gt;  1.020      4       0    0.888  0.0748        0.621        0.971
#&gt;  1.038      3       0    0.888  0.0748        0.621        0.971
#&gt;  1.148      2       0    0.888  0.0748        0.621        0.971
#&gt;  1.250      1       0    0.888  0.0748        0.621        0.971</code></pre>
<p>We can employ the <code>LRT</code> (log-rank test) function in the
<code>OneArm2stage</code> package to evaluate H0: S0 = 0.72 versus H1:
S1 = 0.86 at the landmark time x0=3, utilizing the data provided earlier
(n = 26). The determination of “Go” or “No-go” can be established based
on the computed critical value Z from the following output.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LRT</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">S0=</span><span class="fl">0.72</span>, <span class="at">x0=</span><span class="dv">3</span>, <span class="at">data=</span>dat1)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       O       E       Z </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.0000  1.7562 -0.1840</span></span></code></pre></div>
<p>According to the output provided above, the test statistic Z is
-0.1840, which is larger than the critical value for the 1st stage, c1 =
-0.7274 (refer to Example 1). Hence, the decision is to proceed with a
“Go,” and the trial will advance to the 2nd stage. As a result, we will
enroll an additional 19 patients (45 - 26 = 19). We assume the final
dataset, after adding these 19 patients, is as presented below.</p>
<pre><code>#&gt;         Entry       time status     Total
#&gt; 29 0.00140574 5.24859426      0 5.2500000
#&gt; 6  0.10312013 5.14687987      0 5.2500000
#&gt; 17 0.21339149 5.03660851      0 5.2500000
#&gt; 40 0.23144545 5.01855455      0 5.2500000
#&gt; 35 0.25005470 4.99994530      0 5.2500000
#&gt; 9  0.27427333 4.97572667      0 5.2500000
#&gt; 12 0.28694621 4.96305379      0 5.2500000
#&gt; 1  0.31231364 4.93768636      0 5.2500000
#&gt; 45 0.39386846 4.85613154      0 5.2500000
#&gt; 11 0.46469563 0.40297260      1 0.8676682
#&gt; 31 0.49526749 0.34407523      1 0.8393427
#&gt; 2  0.52432672 2.17230221      1 2.6966289
#&gt; 36 0.54814381 4.70185619      0 5.2500000
#&gt; 4  0.59843844 1.13615368      1 1.7345921
#&gt; 19 0.61736320 4.63263680      0 5.2500000
#&gt; 34 0.79154530 2.08970372      1 2.8812490
#&gt; 15 0.84254125 4.40745875      0 5.2500000
#&gt; 32 0.85458721 0.93888589      1 1.7934731
#&gt; 18 0.86393169 4.38606831      0 5.2500000
#&gt; 38 0.93970525 4.31029475      0 5.2500000
#&gt; 41 0.97850867 4.27149133      0 5.2500000
#&gt; 25 0.98962130 3.85422687      1 4.8438482
#&gt; 7  0.99495017 4.25504983      0 5.2500000
#&gt; 21 1.00916177 1.06895090      1 2.0781127
#&gt; 3  1.04841551 4.20158449      0 5.2500000
#&gt; 30 1.06946229 4.18053771      0 5.2500000
#&gt; 10 1.26213296 3.98786704      0 5.2500000
#&gt; 33 1.37873476 3.37933771      1 4.7580725
#&gt; 27 1.41574755 3.83425245      0 5.2500000
#&gt; 16 1.49650919 0.96396078      1 2.4604700
#&gt; 37 1.50312507 2.52477082      1 4.0278959
#&gt; 28 1.59791040 3.65208960      0 5.2500000
#&gt; 13 1.69494269 3.55467264      1 5.2496153
#&gt; 26 1.69756911 3.14664796      1 4.8442171
#&gt; 39 1.77344063 3.47655937      0 5.2500000
#&gt; 24 1.78727022 0.05248067      1 1.8397509
#&gt; 8  1.79758090 1.03943440      1 2.8370153
#&gt; 22 1.82264479 3.35163892      1 5.1742837
#&gt; 23 1.82787640 3.42212360      0 5.2500000
#&gt; 20 1.83294009 0.42523503      1 2.2581751
#&gt; 5  1.93011236 0.56052654      1 2.4906389
#&gt; 44 1.99455539 3.25544461      0 5.2500000
#&gt; 43 2.00936501 3.24063499      0 5.2500000
#&gt; 14 2.01385206 3.23614794      0 5.2500000
#&gt; 42 2.21615320 3.03384680      0 5.2500000</code></pre>
<p>We can construct a Kaplan-Meier survival curve for this combined
dataset (n=45). <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAulBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkDqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2kDq2kGa227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v////RgnxtAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALrUlEQVR4nO2dC3vbthWGaSeetSZZOmnpVsu9rN3Cbm1ac1knypb+/98acMALKAn4ABAgIel8z5PYJHHj64ODK8liz7KqmLsAuYsBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAOgKri5qP62fxyQrvH4m5jT6YsiiaM/O3eM7aLLMmE5+AOyMbHFRAl8LK6SEC1jY8roGIpftkuDgGlV3pAPZ//fhD3907+Xha3P39VFK8/dQXor4lI//xJXOuZCkBvKVBVNIB2IsDNl5sudncsY//wobj9pGL+5404//6TyvGJTHDZhflAp2T51pRM2R9r5RkA+izSe/UAk1MFcgRUL4qbNR3VBUnSKovud1UA7VrVX+sB/WlBQW+/I0BU1QTDpyZ2f9zEbm6pSUoWfHhHFOYz3Yq4crehZOr+WCuPDqgp9hIl1xTICdAPC1U76E/xh42sJZS+/CN/lndLBdCvVWRZVRtNlevhURxuF3f/IkCljE2hVfH7Yxnv7tP+fxRPFPN+I3M5viMZRsS9b061hdCO2/JogAS1P2+eVzIle3KqQE6Aur+g0u//ftPcYUP79qkrQHutomuicJ2zkaFL+hMvKxlEFUIEbGJrx01sJZHG61+6NAZ3tN73EToz6Y+18miAVBrV+19Qcuq8K6C3rV/dfat43bfpU2qqANo1VUL511eWKp1Dsa5FjLJYEyDy1aoGUGztuL8/ZbNCr/66OQKkwoh46yZ7+r8/1srTAxpWNltyTYHcAD3IYq6b4r7+++8rDVDnH/VrpwDdfBR5fr0SHk2WuXEQHSDteABo//xBnf5Hm2NbDVUYWSnUmQ5Tf9yWZwBIM2pbck2BnAA9UPA+tZfVKQvSr50GRNZALMiC2mrUxl73WQ66FM/fv1E++9QdyUrxHf3eUOiOtfLYLMiUnCqQe0expKpTt75leeyD9GsaoK404ozqRNeND2qvtT7o/iBLTbtvetdSF4M7oqpw1/cWumOtPEc+qH734x4kpwrkDkhGXMv/7zbPj62THrRi+jUDoJraV+W7xYmHvWhOmvZZOx4AolZH1jM6L2LLHPQ7IurrfW8c7bFWnmEr9uVGeQx7cqpAfmMxMhXNSXftW+eDTjjpDpAIJ8oszitATb+na37646EF/dT3qDpHPrijpvZ3FLTjYyfdFfseJefTD/rYhl9Sy/D6x6rpRvwmjt53PWntmgGQCKcwydPP3y702P3xQRWTPd/iHXWrt8Jhv/95NbyjNpeWQpdrX57jnvTfYHJNgTAgo0qtb3SxYkBADAiIAQHxlCsQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAOkD6/Dqrl2ZBVaHtxWA1GlYxZnSkQx9UDTa6sIaAalp03T3G2FF5KeoByYVTRaZmE+qltWKWTaxXrB7QXxQfNp+hjgBVDGigBlC7k4Wb+UMdWRBrqMhjseJsNBeguMmlkyegl9Wy2QA3sh99qYCmz3duTQzooGp7VPG5NLcFESEvZzixvH1QbwNRfFCuXDrNb0FdncuT1dyAtBN51rN8ABXtz6LxS3EzDNXc/aDi6Ix3ydJqbgvSAB3kkIkJ5QMoF5M5UAig5sG3KPlaAeWALABQTQ9JVeMmXk8BOmrGcqhl/oB2j2qmrLTZkHzqkJ7CWhsCGPI99EOupUsnf0Avq+bFAZZWrKLnAulZOMO8ownQcCLmLAHtHtXSfGW2IDKyWr3pxBAK53vULzr9M7WCfJC0itrig8jIlIWZ7AyPxXJwQPtEg1UPC7Lk71K09BDT9IM6H9R6dGNyfX05DuJgQ+cKKKAVO5W+A6Dk/igAUFvN0s9J5+CFAgCJDlAlXxhhMo54+fqZxXE7F1Kwo1S9A8quTS1fbuA02DAtUJ9yOSNK55hHykQGHcXtF0/0zz87y3rcqVOjrCCKHYUNNeTycxAgW74nizLeCiYHRLWmXDpWMY98T44tTAvCJjM8kexE9VQLWNIra6yNWPu6EGMgt8Gqe5mSKVFHsd0bU5s2yUwKaEw3KQkgrf/sOVj16/d53PekgOCMYjsjsseD1ZHySSasv51kRjHcgvQQToNVT4/trzQzilU7BvP1QUFF8wruyzHNjGI3XjNCTADIrRcA5t/0n36l8JlR9EluVJDECXgl4jOjGDPfMXnE8E1JZhRj5TutCYyMHvlPPsUowSOnCNHnABQl0xnGYvTaxZFPtEwHaKpJpUMnXRmnm+PmO15TA2o7ismbea9wtiRGtWWJOorR8gX9uej5hUecyYJiacrRfD4+yGe6I3RMO3ErFnvsnXD6wjf8LP2gBMmkB2Rcbk+TL06p9dsewd3kV9CjVmyc4jvpbCbM4jzunABQmv1VIRY02Wg+B525k06viwYUo54lWfaJme/cCnHSavNh/lOuURTSD1LNvHUjuZJlk9V0gCafMHN4uYnDzPVFzwcps7CN5pv1wiwsaD9uz37QaJ6Wnq2j+ZeV+vxSDoDG5Teio2jvK5b07aJrBOSqqljmBCh0/JGwo7hdvMoHULBS9qR3j2Y/xYCmTS6dUgNy30g+kUzrIyd++hU0zh3FnpNOL65iQJ6Apt3+koMSWVDoRvL8lAZQ8Eby/BQACD9QF2UbcCYKAIQfqJtuI3l6hQxW4QN1121BLg/URdlInofClp7hA3UxNpLnoQAflOqBujwV0sw7PFAXL9+5xUMNIAYEFNKKxfhyzQUDore2j/4wwiUD2qsPj4z7BNKFA9rL7hBPd5gDsgVZAtJUD/sgc0BuxUYGtKfCk/bzJJdO3pP2/NmIsQFnSS6dGBAQt2JAPBYD4p40EI/FgNiCgBKNxa55bd6lFbvqtXmHRzJ5ZRXoutfmHR7JvHYLwoPVq16bd9JVr81Pm+/cSlPFIuY7t4ItyPHp+ew2kvsqvIqVIUONa5qTnuYFS7MrHNC4781fPiD7kOy6B6ugi7O/8sGqg1yGGmejFIAcBqsuieZ5FcXaLpY0o2ibMnOwIJei5HkVxKInEOST89Zv++DBqktR8rwKYlH3sJT1xtpRdPHksCh5XrXHoo86qneSx3hTV54IxgFat5++ZECnYhEg5X7GPYrgUpQ8r4JY0vPQu5Xad/+PUp4IRgGqbz6qN7uU6V8WmOdVFKumpmm7iFDBLktnM3iaSwwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSCg+IDAzL/t5SC0Lmme7a7QNlzzq57VXHHQtoOAOFbJ93bbPpT4sjJOqOweRbzKeBtyUdz6CcbaPFe+/WPoQxaxAamlIfPMf21Zt26mNA3XtXnz0xJWYgQUPpEcG5D9JuV6ESqr1UhsgKq7b4yAquB50uiAyJZtEBAg65ym5ZX7ImezDyrfWr2bRbEBqb+/zQoAINuaZG25SVm3jYCa6eQQQrkBqu1Nze7RxECuxoAPFgQ5osyqGFjTNqOnfAEg67K6SRM76b0dUAX9hOkmq2ZXiw1BUFs/dTNvBWT94oBCY7U/owU5xDVp8o6ipZi0Bccsefv2Z5IsrRhtzsjBSeMBgRlQU02MsUtQhWw+CMY1iQerQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBZQeof9ncr/jdoBMoO0BS4Zt244sBAWUMiD5suvhaVLnldqE2r1She1XDlT0g2nx/+0S7+uQmYLDLKrqyB7Tct/+t4719xUPZA2rfuiL+Uzv7gvaqhuusADnsZI2uswI0+rsoATonQA5vlY+vcwKkHmUpp7WjswJE/aBpG7E8AeUkBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEB/R99XRCtP6E6/QAAAABJRU5ErkJggg==" /><!-- --></p>
<p>The survival rates, as estimated using the Kaplan-Meier method, can
also be derived from this hypothetical dataset (dat2, n=45). It is
evident that at approximately 3.03 years, the survival rate is 0.711,
with a 95% confidence interval of (0.555, 0.821).</p>
<pre><code>#&gt; Call: survfit(formula = Surv(time, status) ~ 1, data = dat2, conf.type = &quot;log-log&quot;)
#&gt; 
#&gt;    time n.risk n.event survival std.err lower 95% CI upper 95% CI
#&gt;  0.0525     45       1    0.978  0.0220        0.853        0.997
#&gt;  0.3441     44       1    0.956  0.0307        0.834        0.989
#&gt;  0.4030     43       1    0.933  0.0372        0.807        0.978
#&gt;  0.4252     42       1    0.911  0.0424        0.780        0.966
#&gt;  0.5605     41       1    0.889  0.0468        0.753        0.952
#&gt;  0.9389     40       1    0.867  0.0507        0.727        0.938
#&gt;  0.9640     39       1    0.844  0.0540        0.701        0.923
#&gt;  1.0394     38       1    0.822  0.0570        0.676        0.907
#&gt;  1.0690     37       1    0.800  0.0596        0.651        0.891
#&gt;  1.1362     36       1    0.778  0.0620        0.626        0.874
#&gt;  2.0897     35       1    0.756  0.0641        0.602        0.856
#&gt;  2.1723     34       1    0.733  0.0659        0.578        0.839
#&gt;  2.5248     33       1    0.711  0.0676        0.555        0.821
#&gt;  3.0338     32       0    0.711  0.0676        0.555        0.821
#&gt;  3.1466     31       1    0.688  0.0692        0.531        0.802
#&gt;  3.2361     30       0    0.688  0.0692        0.531        0.802
#&gt;  3.2406     29       0    0.688  0.0692        0.531        0.802
#&gt;  3.2554     28       0    0.688  0.0692        0.531        0.802
#&gt;  3.3516     27       1    0.663  0.0712        0.503        0.781
#&gt;  3.3793     26       1    0.637  0.0728        0.477        0.760
#&gt;  3.4221     25       0    0.637  0.0728        0.477        0.760
#&gt;  3.4766     24       0    0.637  0.0728        0.477        0.760
#&gt;  3.5547     23       1    0.609  0.0748        0.447        0.737
#&gt;  3.6521     22       0    0.609  0.0748        0.447        0.737
#&gt;  3.8343     21       0    0.609  0.0748        0.447        0.737
#&gt;  3.8542     20       1    0.579  0.0770        0.415        0.712
#&gt;  3.9879     19       0    0.579  0.0770        0.415        0.712
#&gt;  4.1805     18       0    0.579  0.0770        0.415        0.712
#&gt;  4.2016     17       0    0.579  0.0770        0.415        0.712
#&gt;  4.2550     16       0    0.579  0.0770        0.415        0.712
#&gt;  4.2715     15       0    0.579  0.0770        0.415        0.712
#&gt;  4.3103     14       0    0.579  0.0770        0.415        0.712
#&gt;  4.3861     13       0    0.579  0.0770        0.415        0.712
#&gt;  4.4075     12       0    0.579  0.0770        0.415        0.712
#&gt;  4.6326     11       0    0.579  0.0770        0.415        0.712
#&gt;  4.7019     10       0    0.579  0.0770        0.415        0.712
#&gt;  4.8561      9       0    0.579  0.0770        0.415        0.712
#&gt;  4.9377      8       0    0.579  0.0770        0.415        0.712
#&gt;  4.9631      7       0    0.579  0.0770        0.415        0.712
#&gt;  4.9757      6       0    0.579  0.0770        0.415        0.712
#&gt;  4.9999      5       0    0.579  0.0770        0.415        0.712
#&gt;  5.0186      4       0    0.579  0.0770        0.415        0.712
#&gt;  5.0366      3       0    0.579  0.0770        0.415        0.712
#&gt;  5.1469      2       0    0.579  0.0770        0.415        0.712
#&gt;  5.2486      1       0    0.579  0.0770        0.415        0.712</code></pre>
<p>Let’s employ the <code>LRT</code> (log-rank test) to perform the
final analysis using data from a total of 45 patients.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LRT</span>(<span class="at">shape=</span><span class="dv">1</span>, <span class="at">S0=</span><span class="fl">0.72</span>, <span class="at">x0=</span><span class="dv">3</span>, <span class="at">data=</span>dat2)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       O       E       Z </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18.0000 16.0611 -0.4838</span></span></code></pre></div>
<p>Based on the provided output, we observe that the test statistic for
the final stage, denoted as Z, equals -0.4838. This value is smaller
than the critical value for the final stage, c = 1.6061 (refer to
Example 1). Consequently, we are unable to reject the null hypothesis,
and as a result, we must declare the trial as futile. Additionally, the
LRT output also provides information regarding the observed and expected
number of events for the final stage (O = 18 and E = 16.0611).</p>
</div>
<div id="example-5-designing-a-study-with-restricted-follow-up" class="section level3">
<h3>Example 5 (Designing a Study with Restricted Follow-Up)</h3>
<p>Let’s consider designing a study similar to the one presented in
Example 1, but this time with restricted follow-up limited to 3 years
(tf = 3). We can continue to utilize the <code>phase2.TTE</code>
function with the argument <code>restricted=1</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Design5 <span class="ot">&lt;-</span> <span class="fu">phase2.TTE</span>(<span class="at">shape=</span><span class="dv">1</span>,<span class="at">S0=</span><span class="fl">0.72</span>,<span class="at">x0=</span><span class="dv">3</span>,<span class="at">hr=</span><span class="fl">0.459</span>,<span class="at">tf=</span><span class="dv">3</span>,<span class="at">rate=</span><span class="dv">20</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">beta=</span><span class="fl">0.2</span>, <span class="at">restricted=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Design5</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_Optimal</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   n1      c1  n   c     t1 MTSL      ES    PS</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 36 -0.3665 60 1.6 1.7523    6 51.0914 0.357</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_minmax</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   n1      c1  n      c     t1 MTSL      ES     PS</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 37 -0.5517 58 1.6193 1.8222  5.9 51.7359 0.2906</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_Admissible</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     n1      c1  n      c     t1 MTSL      ES     PS      Rho</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 120 37 -0.5625 58 1.6196 1.8066 5.90 51.7260 0.2869 54.86300</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 88  36 -0.4531 59 1.6086 1.7515 5.95 51.2044 0.3252 55.10220</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 232 36 -0.3643 60 1.6000 1.7556 6.00 51.0949 0.3578 55.54745</span></span></code></pre></div>
<p>If we opt to utilize the admissible design based on the
aforementioned results, our accrual time for the 1st stage would be 1.8
years (equivalent to enrolling 37 patients at an accrual rate of 20).
Should the interim analysis result in a “Go” decision, we will then
enroll an additional 21 patients (<span class="math inline">\(58−37=21\)</span>) during the 2nd stage before
proceeding with the final analysis. The critical values for the 1st and
2nd stages are -0.5625 and 1.6196, respectively. In summary, this study
is expected to take a maximum of 5.9 years to complete, with an
anticipated sample size of 51.726 under H0. The probability of early
termination under H0 is 28.69%. When compared to the unrestricted design
(as in Example 1), it appears that the restricted design may require
larger sample sizes and a longer completion time.</p>
</div>
<div id="example-6-simulation" class="section level3">
<h3>Example 6 (Simulation)</h3>
<p>The <code>OneArm2stage</code> package also provides the
<code>Sim</code> function, which allows us to calculate empirical power
and type-I error through simulation based on the specified design
parameters (e.g., t1, n1, n, c1, c) for any two-stage design obtained
from <code>phase2.TTE</code>. The <code>restricted</code> argument can
be utilized to specify whether follow-up is restricted (1) or
unrestricted (0) in <code>Sim</code>.</p>
<p>As part of our examples, we will conduct simulations to determine the
empirical power of the design corresponding to the results obtained from
<code>phase2.TTE</code> in Example 1 using <code>Sim</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Design1<span class="sc">$</span>param</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># shape   S0    hr alpha beta rate x0 tf q_value prStop restricted</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     1 0.72 0.459  0.05  0.2   20  3  3     0.5      0          0</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>Design1<span class="sc">$</span>Two_stage_Optimal</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   n1      c1  n      c     t1 MTSL      ES     PS</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 22 -0.7215 46 1.5952 1.0619  5.3 40.1736 0.2353</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>Design1<span class="sc">$</span>Two_stage_minmax</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   n1     c1  n      c     t1 MTSL      ES     PS</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 34 -0.731 44 1.6257 1.6997  5.2 41.6745 0.2324</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>Design1<span class="sc">$</span>Two_stage_Admissible</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     n1      c1  n      c     t1 MTSL      ES     PS      Rho</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 88  26 -0.7274 45 1.6061 1.2512 5.25 40.3361 0.2335 42.66805</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 98  29 -1.0069 44 1.6293 1.4269 5.20 41.5723 0.1570 42.78615</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 108 21 -0.7393 46 1.5952 1.0326 5.30 40.1736 0.2298 43.08680</span></span></code></pre></div>
<p>For unrestricted designs, you can omit the <code>restricted=0</code>
argument as in the following code, as this is the default setting.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate empirical power based on optimal method, power=0.778</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sim</span>(<span class="at">shape=</span><span class="dv">1</span>, <span class="at">S0=</span><span class="fl">0.72</span>, <span class="at">S1=</span><span class="fl">0.72</span><span class="sc">^</span>(<span class="fl">0.459</span>), <span class="at">x0=</span><span class="dv">3</span>, <span class="at">tf=</span><span class="dv">3</span>, <span class="at">rate=</span><span class="dv">20</span>, <span class="at">t1=</span><span class="fl">1.0619</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">c1=</span><span class="sc">-</span><span class="fl">0.7215</span>, <span class="at">c=</span><span class="fl">1.5952</span>, <span class="at">n1=</span><span class="dv">22</span>, <span class="at">n=</span><span class="dv">46</span>, <span class="at">N=</span><span class="dv">10000</span>, <span class="at">seed=</span><span class="dv">5868</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.778</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate empirical power based on minmax method, power=0.803</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Sim</span>(<span class="at">shape=</span><span class="dv">1</span>, <span class="at">S0=</span><span class="fl">0.72</span>, <span class="at">S1=</span><span class="fl">0.72</span><span class="sc">^</span>(<span class="fl">0.459</span>), <span class="at">x0=</span><span class="dv">3</span>, <span class="at">tf=</span><span class="dv">3</span>, <span class="at">rate=</span><span class="dv">20</span>, <span class="at">t1=</span><span class="fl">1.6997</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">c1=</span><span class="sc">-</span><span class="fl">0.731</span>, <span class="at">c=</span><span class="fl">1.6257</span>, <span class="at">n1=</span><span class="dv">34</span>, <span class="at">n=</span><span class="dv">44</span>, <span class="at">N=</span><span class="dv">10000</span>, <span class="at">seed=</span><span class="dv">5868</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.803</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate empirical power based on admissible method, power=0.789</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">Sim</span>(<span class="at">shape=</span><span class="dv">1</span>, <span class="at">S0=</span><span class="fl">0.72</span>, <span class="at">S1=</span><span class="fl">0.72</span><span class="sc">^</span>(<span class="fl">0.459</span>), <span class="at">x0=</span><span class="dv">3</span>, <span class="at">tf=</span><span class="dv">3</span>, <span class="at">rate=</span><span class="dv">20</span>, <span class="at">t1=</span><span class="fl">1.2512</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">c1=</span><span class="sc">-</span><span class="fl">0.7274</span>, <span class="at">c=</span><span class="fl">1.6061</span>, <span class="at">n1=</span><span class="dv">26</span>, <span class="at">n=</span><span class="dv">45</span>, <span class="at">N=</span><span class="dv">10000</span>, <span class="at">seed=</span><span class="dv">5868</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.789</span></span></code></pre></div>
<p>However, if you intend to use <code>Sim</code> for simulating a
restricted design, it is essential to explicitly specify
<code>restricted=1</code>. Let’s try simulate the restricted design we
obtained in Example 5.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Design5</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_Optimal</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   n1      c1  n   c     t1 MTSL      ES    PS</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 36 -0.3665 60 1.6 1.7523    6 51.0914 0.357</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_minmax</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   n1      c1  n      c     t1 MTSL      ES     PS</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 37 -0.5517 58 1.6193 1.8222  5.9 51.7359 0.2906</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># $Two_stage_Admissible</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     n1      c1  n      c     t1 MTSL      ES     PS      Rho</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 120 37 -0.5625 58 1.6196 1.8066 5.90 51.7260 0.2869 54.86300</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 88  36 -0.4531 59 1.6086 1.7515 5.95 51.2044 0.3252 55.10220</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 232 36 -0.3643 60 1.6000 1.7556 6.00 51.0949 0.3578 55.54745</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate empirical power based on optimal method, power=0.799</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sim</span>(<span class="at">shape=</span><span class="dv">1</span>, <span class="at">S0=</span><span class="fl">0.72</span>, <span class="at">S1=</span><span class="fl">0.72</span><span class="sc">^</span>(<span class="fl">0.459</span>), <span class="at">x0=</span><span class="dv">3</span>, <span class="at">tf=</span><span class="dv">3</span>, <span class="at">rate=</span><span class="dv">20</span>, <span class="at">t1=</span><span class="fl">1.7523</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">c1=</span><span class="sc">-</span><span class="fl">0.3665</span>, <span class="at">c=</span><span class="fl">1.6</span>, <span class="at">n1=</span><span class="dv">36</span>, <span class="at">n=</span><span class="dv">60</span>, <span class="at">N=</span><span class="dv">10000</span>, <span class="at">restricted=</span><span class="dv">1</span>, <span class="at">seed=</span><span class="dv">5868</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.799</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate empirical power based on minmax method, power=0.796</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Sim</span>(<span class="at">shape=</span><span class="dv">1</span>, <span class="at">S0=</span><span class="fl">0.72</span>, <span class="at">S1=</span><span class="fl">0.72</span><span class="sc">^</span>(<span class="fl">0.459</span>), <span class="at">x0=</span><span class="dv">3</span>, <span class="at">tf=</span><span class="dv">3</span>, <span class="at">rate=</span><span class="dv">20</span>, <span class="at">t1=</span><span class="fl">1.8222</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">c1=</span><span class="sc">-</span><span class="fl">0.5517</span>, <span class="at">c=</span><span class="fl">1.6193</span>, <span class="at">n1=</span><span class="dv">37</span>, <span class="at">n=</span><span class="dv">58</span>, <span class="at">N=</span><span class="dv">10000</span>, <span class="at">restricted=</span><span class="dv">1</span>, <span class="at">seed=</span><span class="dv">5868</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.796</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate empirical power based on admissible method, power=0.796</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">Sim</span>(<span class="at">shape=</span><span class="dv">1</span>, <span class="at">S0=</span><span class="fl">0.72</span>, <span class="at">S1=</span><span class="fl">0.72</span><span class="sc">^</span>(<span class="fl">0.459</span>), <span class="at">x0=</span><span class="dv">3</span>, <span class="at">tf=</span><span class="dv">3</span>, <span class="at">rate=</span><span class="dv">20</span>, <span class="at">t1=</span><span class="fl">1.8066</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">c1=</span><span class="sc">-</span><span class="fl">0.5625</span>, <span class="at">c=</span><span class="fl">1.6196</span>, <span class="at">n1=</span><span class="dv">37</span>, <span class="at">n=</span><span class="dv">58</span>, <span class="at">N=</span><span class="dv">10000</span>, <span class="at">restricted=</span><span class="dv">1</span>, <span class="at">seed=</span><span class="dv">5868</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.796</span></span></code></pre></div>
</div>
<div id="example-7-fitting-historical-data" class="section level3">
<h3>Example 7 (Fitting Historical Data)</h3>
<p>Suppose we wish to plan a trial assuming that the failure time
follows the Weibull distribution, but we lack knowledge about the
parameters of the underlying distribution. In such a situation, we can
utilize historical data from previous literature to make an informed
estimation. The <code>IPDfromKM</code> package enables the extraction of
individual patient data (IPD) from digitized Kaplan-Meier plots. The
following example code demonstrates this process using a study conducted
by Wang et al. (2018) on a group of mantle cell lymphoma patients. We
have selected the KM curve depicting overall survival (Figure 2D in Wang
et al., 2018) as the plot from which to extract the IPD.</p>
<p>The steps outlined below provide guidance on how to extract IPD data
on your own, and you are encouraged to try it out.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## First, we take a screenshot of the plot and save it as a .png file. In this example it is named as &quot;wang2018.png&quot;.</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Next, create a path directing to the .png file.</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="do">## e.g. path &lt;-&quot;./vignettes/wang2018.png&quot;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Last, type the following code in console, and follow the prompts to extract data points by clicking your mouse on the plot.</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="do">## df &lt;- getpoints(path, 0, 24, 0, 100)  # 0,24,0,100 are the ranges of x and y-axes in the image</span></span></code></pre></div>
<p>However, for the purposes of this vignette, we have provided a sample
<code>df</code> dataset that can be used directly.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a sample dataset that we already extracted from Wang et al, 2018.</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;df.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;OneArm2stage&quot;</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># risk time points</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>trisk <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">22</span>,<span class="dv">24</span>) </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># number of patients at risk at each risk time point</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>nrisk.radio <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">124</span>,<span class="dv">120</span>,<span class="dv">115</span>,<span class="dv">110</span>,<span class="dv">107</span>,<span class="dv">104</span>,<span class="dv">103</span>,<span class="dv">95</span>,<span class="dv">46</span>,<span class="dv">18</span>,<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">0</span>) </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocess the raw coordinates into an proper format for reco&quot;&quot;nstruct IPD</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>pre_radio <span class="ot">&lt;-</span> <span class="fu">preprocess</span>(<span class="at">dat=</span>df, <span class="at">trisk=</span>trisk, <span class="at">nrisk=</span>nrisk.radio,<span class="at">totalpts=</span><span class="cn">NULL</span>,<span class="at">maxy=</span><span class="dv">100</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Reconstruct IPD</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>est_radio <span class="ot">&lt;-</span> <span class="fu">getIPD</span>(<span class="at">prep=</span>pre_radio,<span class="at">armID=</span><span class="dv">0</span>,<span class="at">tot.events=</span><span class="cn">NULL</span>)</span></code></pre></div>
<p>We can conduct a survival analysis on the reconstructed IPD and
compare the results with those reported in the original paper. The
estimated survival probability at time = 12 is 0.86, with a 95% CI of
(0.8, 0.92). This closely aligns with the result reported in Wang et
al., 2018, which is 0.87 with a 95% CI of (0.79, 0.92).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plot_ex5 <span class="ot">&lt;-</span> <span class="fu">survreport</span>(<span class="at">ipd1=</span>est_radio<span class="sc">$</span>IPD,<span class="at">ipd2=</span><span class="cn">NULL</span>,<span class="at">arms=</span><span class="dv">1</span>,<span class="at">interval=</span><span class="dv">2</span>,<span class="at">s=</span><span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">0.5</span>,<span class="fl">0.25</span>),<span class="at">showplots=</span>F)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>plot_ex5<span class="sc">$</span>arm1<span class="sc">$</span>survprob</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Surv     SE 0.95LCI 0.95UCI</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time = 2  0.9677 0.0159  0.9371  0.9993</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time = 4  0.9433 0.0208  0.9033  0.9850</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time = 6  0.9184 0.0247  0.8712  0.9682</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time = 8  0.8934 0.0280  0.8402  0.9499</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time = 10 0.8681 0.0307  0.8099  0.9305</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time = 12 0.8597 0.0316  0.8000  0.9239</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time = 14 0.8254 0.0347  0.7602  0.8962</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time = 16 0.7820 0.0379  0.7112  0.8599</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time = 18 0.7650 0.0407  0.6893  0.8491</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time = 20 0.6400 0.0914  0.4837  0.8467</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time = 22 0.6400 0.0914  0.4837  0.8467</span></span></code></pre></div>
<p>Now, using the reconstructed IPD, we can fit a parametric regression
model assuming a Weibull distribution (the most widely used option).
Before proceeding, we need to reformat the IPD data to make it
compatible with the <code>FitDat</code> function in our package.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ipd <span class="ot">&lt;-</span> est_radio<span class="sc">$</span>IPD</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>dat3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(ipd)),ipd<span class="sc">$</span>time, ipd<span class="sc">$</span>status))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dat3) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Entry&quot;</span>, <span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Cens&quot;</span>)</span></code></pre></div>
<p>We apply the <code>FitDat</code> function to fit the historical data
with the Weibull distribution. This function provides the AIC value for
the fitted model and estimates the parameters. We can then use these
parameter estimates to design the trial, as demonstrated in Examples 1
and 5.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>modelWB<span class="ot">&lt;-</span> <span class="fu">FitDat</span>(dat3)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>modelWB<span class="sc">$</span>AIC</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Weibull </span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 301.7776</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>modelWB<span class="sc">$</span>parameter.estimates</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $Weibull</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     shape     scale </span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.1133671 3.9939753</span></span></code></pre></div>
</div>
</div>
<div id="reference" class="section level2">
<h2>Reference</h2>
<p>Wu, J, Chen L, Wei J, Weiss H, Chauhan A. (2020). Two-stage phase II
survival trial design. Pharmaceutical Statistics. 19:214-229. <a href="https://doi.org/10.1002/pst.1983" class="uri">https://doi.org/10.1002/pst.1983</a></p>
<p>Wang, M., Rule, S., Zinzani, P. L., Goy, A., Casasnovas, O., Smith,
S. D.,…, Robak, T. (2018). Acalabrutinib in relapsed or refractory
mantle cell lymphoma (ACE-LY-004): a single-arm, multicentre, phase 2
trial. The Lancet. 391(10121), 659–667. <a href="https://doi.org/10.1016/s0140-6736(17)33108-2" class="uri">https://doi.org/10.1016/s0140-6736(17)33108-2</a></p>
<p>Jung, S.-H., (2004). Admissible two-stage designs for phase II cancer
clinical trials. Statistics in Medicine. 23:561-569. <a href="https://doi.org/10.1002/sim.1600" class="uri">https://doi.org/10.1002/sim.1600</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
